<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How To Write Error Messages That Don’t Suck</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How To Write Error Messages That Don’t Suck</h1>
</header>
<section data-field="subtitle" class="p-summary">
“A validation error occurred.” Yep. Thanks!
</section>
<section data-field="body" class="e-content">
<section name="9d0c" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1990" id="1990" class="graf graf--h3 graf--leading graf--title">How To Write Error Messages That Don’t Suck</h3><figure name="ffc0" id="ffc0" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 438px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 62.5%;"></div><img class="graf-image" data-image-id="1*oCtk28IdNdpjnyMGiRsfLA.jpeg" data-width="1680" data-height="1050" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*oCtk28IdNdpjnyMGiRsfLA.jpeg"></div><figcaption class="imageCaption">Learning JavaScript, with Justin Fuller</figcaption></figure><p name="c36a" id="c36a" class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“A validation error occurred.” Yep. Thanks!</p><p name="c72a" id="c72a" class="graf graf--p graf-after--p">The release is imminent; this is the last update that needs to be verified, and I get an error message that’s as useful as the close button on an elevator.</p><p name="8030" id="8030" class="graf graf--p graf-after--p">It turns out that it <em class="markup--em markup--p-em">is</em> a validation error, kind of. The input I am giving is a duplicate. It’s valid, it just already exists!</p><p name="de1a" id="de1a" class="graf graf--p graf-after--p">Wouldn’t it be so helpful to know that?</p><p name="5f8f" id="5f8f" class="graf graf--p graf-after--p">In fact it would be helpful to be informed of several things when errors happen. I don’t need to know everything. The history of programming won’t help me here. The message should give me just enough info for me to get this error fixed so that I can finish my work, go home, and play with my kids.</p><h4 name="92ab" id="92ab" class="graf graf--h4 graf-after--p">What makes an Error?</h4><p name="83f6" id="83f6" class="graf graf--p graf-after--h4">In JavaScript an error object always has the name, message, and stack properties. The name gives you an at-a-glance classification of the error. The stack tells you where it happened. The message? Well, according to some developers, you don’t need to worry about that! “The stack trace gives you everything you need.”</p><p name="8490" id="8490" class="graf graf--p graf-after--p">Please, don’t be one of those developers.</p><h4 name="f69e" id="f69e" class="graf graf--h4 graf-after--p">Useful Error Messages</h4><p name="7286" id="7286" class="graf graf--p graf-after--h4">Raise your right hand, place your left hand on a copy of “Clean Code” and repeat after me.</p><p name="b357" id="b357" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“I swear to include enough detail in my error messages that future developers will easily be able to determine what went wrong and what they need to do to fix it.”</p><h4 name="1a54" id="1a54" class="graf graf--h4 graf-after--p">What Happened</h4><p name="c612" id="c612" class="graf graf--p graf-after--h4">When a police officer pulls you over to give you a ticket, does it say “Bad Driving”? No! It says you were going 65 miles per hour in a 25 miles per hour school zone, you passed a stopped bus, and your car hasn’t been inspected in four years! Sure, you’re going to jail, but at least you know <em class="markup--em markup--p-em">why</em>.</p><p name="d7d9" id="d7d9" class="graf graf--p graf-after--p">So the error message from earlier should not be, “A validation error occurred”, but instead:</p><pre name="b583" id="b583" class="graf graf--pre graf-after--p">Unable to save model &quot;user&quot; because the property &quot;email&quot; with value &quot;JustinFuller@company.com&quot; already exists.</pre><p name="ece1" id="ece1" class="graf graf--p graf-after--pre">Instead of a simple error that says, “Invalid option” use:</p><pre name="e72c" id="e72c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">The option &quot;update&quot; is not valid. Valid options include &quot;upsert&quot;, &quot;get&quot;, and &quot;delete&quot;.</code></pre><p name="4bd5" id="4bd5" class="graf graf--p graf-after--pre">These updated error messages attempt to help us understand the cause, giving us a start toward the solution.</p><h4 name="3856" id="3856" class="graf graf--h4 graf-after--p">How It Might Have Happened</h4><p name="864b" id="864b" class="graf graf--p graf-after--h4">Now that the error is describing what exactly went wrong, it’s time to help the poor soul who stumbled into this predicament begin to climb back out. Watch carefully. When done correctly it will seem like you’re reaching forward through time by anticipating what could have led to this unfortunate turn of events. You’ll be right there with that future developer — maybe yourself — telling them that everything is fine, that you’ll get through this together.</p><p name="9b4a" id="9b4a" class="graf graf--p graf-after--p">You’ll begin by explaining what happened.</p><p name="3d52" id="3d52" class="graf graf--p graf-after--p">For anything that has a prerequisite step, such as configuration or validation, you can suggest to verify that step has been completed. Don’t worry if your error messages get long. It’s better to provide too much information than not enough.</p><p name="2d1a" id="2d1a" class="graf graf--p graf-after--p">I’ll add more detail to one of the earlier examples:</p><pre name="0de2" id="0de2" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">The option “update” is not valid. Valid options include “upsert”, “get”, and “delete”. <strong class="markup--strong markup--pre-strong">If you expected “update” to be an option, you must first export it from the file: &quot;./src/controllers/index.js&quot;.</strong></code></pre><p name="871c" id="871c" class="graf graf--p graf-after--pre">Now you are anticipating how this might have happened: the developer probably just forgot to export the new option. The error becomes a reminder of that step. You’ve now shown two possible causes of the error; the first is a possible typo (here are the valid options) and the second is a configuration error (here’s where it should be exported).</p><p name="9009" id="9009" class="graf graf--p graf-after--p">The React library does an excellent job of anticipating how errors might have occurred. They don’t address every edge case, but they do give helpful hints for the most common errors. For example, you can’t use the function <code class="markup--code markup--p-code">reactDom.renderToNodeString()</code> in the browser because node streams don’t exist there. So React gives you a suggestion of how it happened and how to fix it:</p><pre name="70a3" id="70a3" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">ReactDOMServer.renderToNodeStream(): The streaming API is not available in the browser. Use ReactDOMServer.renderToString() instead</code>.</pre><p name="10ff" id="10ff" class="graf graf--p graf-after--pre">There could be other ways for that error to occur, but they guess that the most common reason is that <code class="markup--code markup--p-code">renderToNodeStream</code> was called in the browser.</p><h4 name="9658" id="9658" class="graf graf--h4 graf-after--p">Relevant Data</h4><p name="4935" id="4935" class="graf graf--p graf-after--h4">While writing error messages you must remember that applications rarely do only one thing at a time. So when errors occur it’s a challenge to find the state of the application at that time. For this reason it’s very important to capture the relevant data and relay it back to the developer so that they can pinpoint the cause.</p><p name="2489" id="2489" class="graf graf--p graf-after--p">In the first example I included the phrase:</p><pre name="4adf" id="4adf" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">The property “email” with value “JustinFuller@company.com” already exists.</code></pre><p name="3520" id="3520" class="graf graf--p graf-after--pre">This is very useful, but could be impractical. It may take too much effort or time to create natural language errors for every variation of data, or in some cases we may simply be passing on a failure outside of our own control, so the only option left is to give a good description and include as much relevant data that is safe to print.</p><p name="8531" id="8531" class="graf graf--p graf-after--p">The choice of what data is safe to print is tricky: if you choose exactly what properties to include then you end up modifying the list every time there is a new property, or, worse, you forget and it doesn’t show up when needed; on the other hand you can remove properties that are known to be unsafe, but here you risk adding a new property and forgetting to exclude it, causing leaked sensitive data. You have to use your judgement and consider your company rules. Does your software handle highly valuable or personal data that should not be written to an non-encrypted destination? Thoughtlessly logging out every object that causes an error is liable to get you fired from some jobs, while at others it’s the standard operating procedure. So please, use common sense and be careful!</p><h4 name="b64c" id="b64c" class="graf graf--h4 graf-after--p">Unexpected Errors</h4><p name="6daa" id="6daa" class="graf graf--p graf-after--h4">There are two ways to include relevant data when you don’t know exactly which property or action caused the error.</p><p name="726a" id="726a" class="graf graf--p graf-after--p">The first should be used when you intend for the error to be read by humans, you put the data right in the message: <code class="markup--code markup--p-code">An error was received: “Duplicate entry found for user.email”, while upserting user: { “email”: “justinfuller@company.com” }.</code> This error style has its drawbacks, like the entire object being placed into the error message that could be sent somewhere unintended. If, however, you know it’s safe then this style has the advantage of giving complete details about the situation.</p><p name="aa54" id="aa54" class="graf graf--p graf-after--p">In other cases you may not want the data to leak to a log file or an API response. You can provide a reference ID, a time stamp that can be manually or automatically referenced to data later, or some other property that will allow the developer to track down the pesky data-point that caused an error.</p><h4 name="25b3" id="25b3" class="graf graf--h4 graf-after--p">Expected Errors</h4><p name="d3bf" id="d3bf" class="graf graf--p graf-after--h4">I’ll be the first to admit that I’m prone to making simple mistakes. I type “upswert” instead of “upsert”; I type “npm tes” instead of “npm test”. So it’s really refreshing when I get an error message saying:</p><pre name="661c" id="661c" class="graf graf--pre graf-after--p">Unknown command, &quot;npm tes&quot;. Did you mean npm test?</pre><p name="230d" id="230d" class="graf graf--p graf-after--pre">When the developers prepped for this, they obviously gazed into the future and saw that someone would make that typo — or maybe they just know that humans are prone to silly errors .</p><p name="32d8" id="32d8" class="graf graf--p graf-after--p">Whenever there’s a step in a process that can go predictably wrong you have an opportunity to prepare clear guidance on what went wrong and how to fix it.</p><h4 name="ba77" id="ba77" class="graf graf--h4 graf-after--p">Steps To Fix The Issue</h4><p name="caf5" id="caf5" class="graf graf--p graf-after--h4">For some errors it will be possible to give a solution to the error instead of just reporting that it happened. Some times it will be easy, like earlier when we showed the correct options after accidentally typing “update” instead of “upsert”. Other times you’ll need to put in more effort to give the user enough information to correct their mistake, like if you’ve detected a recursive dependency, and you need to tell them where the loop is and what they must do to remove it.</p><h4 name="42ce" id="42ce" class="graf graf--h4 graf-after--p">An error that doesn’t suck</h4><p name="927f" id="927f" class="graf graf--p graf-after--h4 graf--trailing">So, do you want to provide helpful error messages? In the next error you write, try to include a full description of what happened, how it might have happened, any relevant data that is safe to include, and any steps that might help resolve the problem.</p></div></div></section><section name="34d0" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="defe" id="defe" class="graf graf--p graf--leading">Hi, I’m Justin Fuller. I’m so glad you read my post! I need to let you know that everything I’ve written here is my own opinion and is not intended to represent my employer in any way. All code samples are my own, and are completely unrelated to Bank Of America’s code.</p><p name="d552" id="d552" class="graf graf--p graf-after--p graf--trailing">I’d also love to hear from you, please feel free to connect with me on <a href="https://www.linkedin.com/in/justin-fuller-8726b2b1/" data-href="https://www.linkedin.com/in/justin-fuller-8726b2b1/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">LinkedIn</a>, <a href="https://github.com/justindfuller" data-href="https://github.com/justindfuller" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github</a>, or <a href="https://medium.com/@justindanielfuller" data-href="https://medium.com/@justindanielfuller" class="markup--anchor markup--p-anchor" target="_blank">Medium</a>. Thanks again for reading!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@justindanielfuller" class="p-author h-card">Justin Fuller</a> on <a href="https://medium.com/p/f31c53b64c3e"><time class="dt-published" datetime="2018-11-28T16:50:35.009Z">November 28, 2018</time></a>.</p><p><a href="https://medium.com/@justindanielfuller/how-to-write-error-messages-that-dont-suck-f31c53b64c3e" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 8, 2018.</p></footer></article></body></html>